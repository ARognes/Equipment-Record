var at=Object.defineProperty,ot=Object.defineProperties;var ut=Object.getOwnPropertyDescriptors;var He=Object.getOwnPropertySymbols;var ft=Object.prototype.hasOwnProperty,ct=Object.prototype.propertyIsEnumerable;var qe=(n,e,s)=>e in n?at(n,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[e]=s,ye=(n,e)=>{for(var s in e||(e={}))ft.call(e,s)&&qe(n,s,e[s]);if(He)for(var s of He(e))ct.call(e,s)&&qe(n,s,e[s]);return n},Le=(n,e)=>ot(n,ut(e));import{S as oe,i as ue,s as fe,e as I,t as W,c as A,a as y,h as F,d as g,b as d,g as j,H as v,V as C,j as ae,aj as ht,ak as Ue,a1 as Ve,k as q,m as L,a0 as Ke,O as M,L as we,N as tt,ai as dt,al as gt,am as _t,a5 as Pe,W as je,a6 as ge,C as G,P as R,Q as J,R as ne,z as Ee,T as ie,a7 as ve,w as ee,x as te,y as se,q as U,o as P,B as le,p as Ie,f as mt,a8 as be,n as Ae,an as pt}from"../../../chunks/vendor-5a111b6e.js";import{G as vt}from"../../../chunks/Gallery-0531e052.js";import{p as st}from"../../../chunks/stores-7610695a.js";import{a as lt,q as bt,g as kt,c as yt,b as wt,d as Ce,u as Me}from"../../../chunks/firebase-2109294e.js";import{s as ze}from"../../../chunks/storage-c0d15549.js";import{g as Et}from"../../../chunks/navigation-0e6511d1.js";import"../../../chunks/Loading-423e8b8f.js";/* empty css                                                            */import"../../../chunks/app-db9d6f6f.js";import"../../../chunks/preload-helper-e4860ae8.js";import"../../../chunks/singletons-d1fb5791.js";function Re(n,e,s){const t=n.slice();return t[15]=e[s],t[17]=s,t}function Je(n,e,s){const t=n.slice();return t[18]=e[s],t[17]=s,t}function Ge(n){let e,s=n[3]?"-":"+",t,a,r;return{c(){e=I("button"),t=W(s),this.h()},l(l){e=A(l,"BUTTON",{id:!0,class:!0});var o=y(e);t=F(o,s),o.forEach(g),this.h()},h(){d(e,"id","showMoreAssignments"),d(e,"class","svelte-dce25p")},m(l,o){j(l,e,o),v(e,t),a||(r=C(e,"click",n[11]),a=!0)},p(l,o){o&8&&s!==(s=l[3]?"-":"+")&&ae(t,s)},d(l){l&&g(e),a=!1,r()}}}function Xe(n){let e,s,t,a=n[4],r=[];for(let l=0;l<a.length;l+=1)r[l]=Qe(Je(n,a,l));return{c(){e=I("select");for(let l=0;l<r.length;l+=1)r[l].c();this.h()},l(l){e=A(l,"SELECT",{id:!0,class:!0});var o=y(e);for(let i=0;i<r.length;i+=1)r[i].l(o);o.forEach(g),this.h()},h(){d(e,"id","reassign"),d(e,"class","svelte-dce25p"),n[1]===void 0&&ht(()=>n[12].call(e))},m(l,o){j(l,e,o);for(let i=0;i<r.length;i+=1)r[i].m(e,null);Ue(e,n[1]),s||(t=C(e,"change",n[12]),s=!0)},p(l,o){if(o&16){a=l[4];let i;for(i=0;i<a.length;i+=1){const h=Je(l,a,i);r[i]?r[i].p(h,o):(r[i]=Qe(h),r[i].c(),r[i].m(e,null))}for(;i<r.length;i+=1)r[i].d(1);r.length=a.length}o&18&&Ue(e,l[1])},d(l){l&&g(e),Ve(r,l),s=!1,t()}}}function Qe(n){let e,s=n[18].name+"",t,a;return{c(){e=I("option"),t=W(s),this.h()},l(r){e=A(r,"OPTION",{});var l=y(e);t=F(l,s),l.forEach(g),this.h()},h(){e.__value=a=n[18],e.value=e.__value},m(r,l){j(r,e,l),v(e,t)},p(r,l){l&16&&s!==(s=r[18].name+"")&&ae(t,s),l&16&&a!==(a=r[18])&&(e.__value=a,e.value=e.__value)},d(r){r&&g(e)}}}function We(n){let e,s,t=(n[15].projectName||"")+"",a,r,l,o,i=(n[15].username||"")+"",h,u,f,_,b=(n[15].createdAt?new Date(n[15].createdAt.seconds*1e3).toLocaleString():"")+"",D,B;return{c(){e=I("div"),s=I("a"),a=W(t),l=q(),o=I("a"),h=W(i),f=q(),_=I("p"),D=W(b),B=q(),this.h()},l(E){e=A(E,"DIV",{class:!0});var c=y(e);s=A(c,"A",{"sveltekit:prefetch":!0,href:!0,class:!0});var k=y(s);a=F(k,t),k.forEach(g),l=L(c),o=A(c,"A",{"sveltekit:prefetch":!0,href:!0,class:!0});var N=y(o);h=F(N,i),N.forEach(g),f=L(c),_=A(c,"P",{class:!0});var T=y(_);D=F(T,b),T.forEach(g),B=L(c),c.forEach(g),this.h()},h(){d(s,"sveltekit:prefetch",""),d(s,"href",r=`/${n[5].params.businessName}/projects/${n[15].projectName}`),d(s,"class","svelte-dce25p"),d(o,"sveltekit:prefetch",""),d(o,"href",u=`/${n[5].params.businessName}/users/${n[15].username}`),d(o,"class","svelte-dce25p"),d(_,"class","svelte-dce25p"),d(e,"class","assignment svelte-dce25p")},m(E,c){j(E,e,c),v(e,s),v(s,a),v(e,l),v(e,o),v(o,h),v(e,f),v(e,_),v(_,D),v(e,B)},p(E,c){c&4&&t!==(t=(E[15].projectName||"")+"")&&ae(a,t),c&36&&r!==(r=`/${E[5].params.businessName}/projects/${E[15].projectName}`)&&d(s,"href",r),c&4&&i!==(i=(E[15].username||"")+"")&&ae(h,i),c&36&&u!==(u=`/${E[5].params.businessName}/users/${E[15].username}`)&&d(o,"href",u),c&4&&b!==(b=(E[15].createdAt?new Date(E[15].createdAt.seconds*1e3).toLocaleString():"")+"")&&ae(D,b)},d(E){E&&g(e)}}}function Dt(n){let e,s,t,a,r,l,o=n[2].length&&Ge(n),i=n[0]&&n[4].length&&n[2].length&&Xe(n),h=n[2],u=[];for(let f=0;f<h.length;f+=1)u[f]=We(Re(n,h,f));return{c(){e=I("div"),s=I("div"),t=W(`Assigned
		`),o&&o.c(),a=q(),i&&i.c(),r=q(),l=I("div");for(let f=0;f<u.length;f+=1)u[f].c();this.h()},l(f){e=A(f,"DIV",{id:!0,class:!0});var _=y(e);s=A(_,"DIV",{id:!0,class:!0});var b=y(s);t=F(b,`Assigned
		`),o&&o.l(b),a=L(b),i&&i.l(b),b.forEach(g),r=L(_),l=A(_,"DIV",{class:!0});var D=y(l);for(let B=0;B<u.length;B+=1)u[B].l(D);D.forEach(g),_.forEach(g),this.h()},h(){d(s,"id","title"),d(s,"class","svelte-dce25p"),d(l,"class","scrollable svelte-dce25p"),Ke(l,"scrollable-more",n[3]),d(e,"id","assignments"),d(e,"class","svelte-dce25p")},m(f,_){j(f,e,_),v(e,s),v(s,t),o&&o.m(s,null),v(s,a),i&&i.m(s,null),v(e,r),v(e,l);for(let b=0;b<u.length;b+=1)u[b].m(l,null)},p(f,[_]){if(f[2].length?o?o.p(f,_):(o=Ge(f),o.c(),o.m(s,a)):o&&(o.d(1),o=null),f[0]&&f[4].length&&f[2].length?i?i.p(f,_):(i=Xe(f),i.c(),i.m(s,null)):i&&(i.d(1),i=null),_&36){h=f[2];let b;for(b=0;b<h.length;b+=1){const D=Re(f,h,b);u[b]?u[b].p(D,_):(u[b]=We(D),u[b].c(),u[b].m(l,null))}for(;b<u.length;b+=1)u[b].d(1);u.length=h.length}_&8&&Ke(l,"scrollable-more",f[3])},i:M,o:M,d(f){f&&g(e),o&&o.d(),i&&i.d(),Ve(u,f)}}}function Nt(n,e,s){let t,a;we(n,st,k=>s(5,a=k));const r=tt("userData");we(n,r,k=>s(10,t=k));let{item:l,editing:o}=e,i=[],h,u=!1,f=!1;async function _(){s(8,f=!0),s(2,i=await bt(t.businessID,"assignments",[dt("equipmentID","==",l.id),gt("createdAt","desc")])),b()}function b(){i!=null&&i.length&&s(1,h=D.find(k=>k.id==i[0].projectID))}let D=[],B=!1;const E=()=>s(3,u=!u);function c(){h=_t(this),s(1,h),s(4,D),s(0,o),s(9,B),s(10,t)}return n.$$set=k=>{"item"in k&&s(7,l=k.item),"editing"in k&&s(0,o=k.editing)},n.$$.update=()=>{n.$$.dirty&2&&h&&(s(7,l.projectAssigned=h.name,l),s(7,l.projectID=h.id,l)),n.$$.dirty&1408&&t&&l&&!f&&_(),n.$$.dirty&1&&o&&b(),n.$$.dirty&1537&&o&&!B&&(s(9,B=!0),lt(t.businessID,"projects").then(k=>{s(4,D=k),b()}))},[o,h,i,u,D,a,r,l,f,B,t,E,c]}class It extends oe{constructor(e){super();ue(this,e,Nt,Dt,fe,{item:7,editing:0})}}function Fe(n,e,s){const t=n.slice();return t[14]=e[s],t[15]=e,t[16]=s,t}function At(n){let e,s,t,a,r,l;function o(...h){return n[7](n[16],...h)}let i=n[16]+1<n[0].length&&Ye(n);return{c(){e=I("div"),s=I("input"),a=q(),i&&i.c(),this.h()},l(h){e=A(h,"DIV",{class:!0});var u=y(e);s=A(u,"INPUT",{type:!0,placeholder:!0,class:!0}),a=L(u),i&&i.l(u),u.forEach(g),this.h()},h(){d(s,"type","text"),d(s,"placeholder","Attribute"),s.value=t=n[14].key||n[14].editKey||"",d(s,"class","svelte-1svt6o0"),d(e,"class","div-key svelte-1svt6o0")},m(h,u){j(h,e,u),v(e,s),v(e,a),i&&i.m(e,null),r||(l=C(s,"input",o),r=!0)},p(h,u){n=h,u&1&&t!==(t=n[14].key||n[14].editKey||"")&&s.value!==t&&(s.value=t),n[16]+1<n[0].length?i?i.p(n,u):(i=Ye(n),i.c(),i.m(e,null)):i&&(i.d(1),i=null)},d(h){h&&g(e),i&&i.d(),r=!1,l()}}}function Vt(n){let e,s=n[14].key+"",t;return{c(){e=I("p"),t=W(s),this.h()},l(a){e=A(a,"P",{class:!0});var r=y(e);t=F(r,s),r.forEach(g),this.h()},h(){d(e,"class","key svelte-1svt6o0")},m(a,r){j(a,e,r),v(e,t)},p(a,r){r&1&&s!==(s=a[14].key+"")&&ae(t,s)},d(a){a&&g(e)}}}function Ye(n){let e,s,t,a,r,l,o,i=n[16]>0&&jt(n),h=n[16]<n[0].length-2&&Ze(n);function u(){return n[10](n[16])}return{c(){e=I("div"),i&&i.c(),s=q(),h&&h.c(),t=q(),a=I("button"),r=W("-"),this.h()},l(f){e=A(f,"DIV",{class:!0});var _=y(e);i&&i.l(_),s=L(_),h&&h.l(_),t=L(_),a=A(_,"BUTTON",{class:!0});var b=y(a);r=F(b,"-"),b.forEach(g),_.forEach(g),this.h()},h(){d(a,"class","svelte-1svt6o0"),d(e,"class","attribute-actions svelte-1svt6o0")},m(f,_){j(f,e,_),i&&i.m(e,null),v(e,s),h&&h.m(e,null),v(e,t),v(e,a),v(a,r),l||(o=C(a,"click",u),l=!0)},p(f,_){n=f,n[16]>0&&i.p(n,_),n[16]<n[0].length-2?h?h.p(n,_):(h=Ze(n),h.c(),h.m(e,t)):h&&(h.d(1),h=null)},d(f){f&&g(e),i&&i.d(),h&&h.d(),l=!1,o()}}}function jt(n){let e,s,t,a;function r(){return n[8](n[16])}return{c(){e=I("button"),s=W("^"),this.h()},l(l){e=A(l,"BUTTON",{class:!0});var o=y(e);s=F(o,"^"),o.forEach(g),this.h()},h(){d(e,"class","svelte-1svt6o0")},m(l,o){j(l,e,o),v(e,s),t||(a=C(e,"click",r),t=!0)},p(l,o){n=l},d(l){l&&g(e),t=!1,a()}}}function Ze(n){let e,s,t,a;function r(){return n[9](n[16])}return{c(){e=I("button"),s=W("v"),this.h()},l(l){e=A(l,"BUTTON",{class:!0});var o=y(e);s=F(o,"v"),o.forEach(g),this.h()},h(){d(e,"class","svelte-1svt6o0")},m(l,o){j(l,e,o),v(e,s),t||(a=C(e,"click",r),t=!0)},p(l,o){n=l},d(l){l&&g(e),t=!1,a()}}}function $e(n){let e,s,t,a,r=n[16],l,o,i;function h(E,c){return E[1]?At:Vt}let u=h(n),f=u(n);function _(){n[11].call(t,n[15],n[16])}const b=()=>n[12](t,r),D=()=>n[12](null,r);function B(...E){return n[13](n[16],...E)}return{c(){e=I("div"),f.c(),s=q(),t=I("textarea"),l=q(),this.h()},l(E){e=A(E,"DIV",{class:!0});var c=y(e);f.l(c),s=L(c),t=A(c,"TEXTAREA",{placeholder:!0,rows:!0,class:!0}),y(t).forEach(g),l=L(c),c.forEach(g),this.h()},h(){t.readOnly=a=!n[1],d(t,"placeholder","Empty"),d(t,"rows","1"),d(t,"class","svelte-1svt6o0"),d(e,"class","attribute")},m(E,c){j(E,e,c),f.m(e,null),v(e,s),v(e,t),Pe(t,n[14].editVal),b(),v(e,l),o||(i=[C(t,"input",_),C(t,"input",B)],o=!0)},p(E,c){n=E,u===(u=h(n))&&f?f.p(n,c):(f.d(1),f=u(n),f&&(f.c(),f.m(e,s))),c&2&&a!==(a=!n[1])&&(t.readOnly=a),c&1&&Pe(t,n[14].editVal),r!==n[16]&&(D(),r=n[16],b())},d(E){E&&g(e),f.d(),D(),o=!1,je(i)}}}function Tt(n){let e,s=n[0]||[],t=[];for(let a=0;a<s.length;a+=1)t[a]=$e(Fe(n,s,a));return{c(){e=I("div");for(let a=0;a<t.length;a+=1)t[a].c();this.h()},l(a){e=A(a,"DIV",{id:!0,class:!0});var r=y(e);for(let l=0;l<t.length;l+=1)t[l].l(r);r.forEach(g),this.h()},h(){d(e,"id","attributes"),d(e,"class","svelte-1svt6o0")},m(a,r){j(a,e,r);for(let l=0;l<t.length;l+=1)t[l].m(e,null)},p(a,[r]){if(r&127){s=a[0]||[];let l;for(l=0;l<s.length;l+=1){const o=Fe(a,s,l);t[l]?t[l].p(o,r):(t[l]=$e(o),t[l].c(),t[l].m(e,null))}for(;l<t.length;l+=1)t[l].d(1);t.length=s.length}},i:M,o:M,d(a){a&&g(e),Ve(t,a)}}}const Bt=10;function Ot(n,e,s){let{attributes:t,editing:a}=e,r=[];function l(c,k){c.target.style.height="auto";let N=c.target.offsetHeight-c.target.clientHeight;c.target.style.height=c.target.scrollHeight+N+"px",s(0,t[k].editVal=c.target.value,t)}function o(c,k){s(0,t[k].editKey=c.target.value,t),console.log(t.reduce((N,T)=>T.hidden?++N:N,0))}function i(c,k){if(k&&c<t.length-2){t.splice(c+1,0,t.splice(c,1)[0]);const N=r[c],T=r[c+1];if(N!=null&&T!=null){N.style.height="auto";let O=N.offsetHeight-N.clientHeight;T.style.height=N.scrollHeight+O+"px"}}else if(!k&&c>0){t.splice(c-1,0,t.splice(c,1)[0]);const N=r[c],T=r[c-1];if(N!=null&&T!=null){N.style.height="auto";let O=N.offsetHeight-N.clientHeight;T.style.height=N.scrollHeight+O+"px"}}s(0,t),s(1,a)}function h(c){t.splice(c,1),s(0,t),s(1,a)}const u=(c,k)=>o(k,c),f=c=>i(c,!1),_=c=>i(c,!0),b=c=>h(c);function D(c,k){c[k].editVal=this.value,s(0,t),s(1,a)}function B(c,k){ge[c?"unshift":"push"](()=>{r[k]=c,s(2,r)})}const E=(c,k)=>l(k,c);return n.$$set=c=>{"attributes"in c&&s(0,t=c.attributes),"editing"in c&&s(1,a=c.editing)},n.$$.update=()=>{var c,k;if(n.$$.dirty&4)for(let N=0;N<r.length;N++){const T=r[N];if(T==null)continue;T.style.height="auto";let O=T.offsetHeight-T.clientHeight;T.style.height=T.scrollHeight+O+"px"}if(n.$$.dirty&3&&a&&t.length<Bt&&(t[t.length-1].key.length||t[t.length-1].val.length||((c=t[t.length-1].editKey)==null?void 0:c.length)||((k=t[t.length-1].editVal)==null?void 0:k.length))&&s(0,t[t.length]={key:"",val:""},t),n.$$.dirty&1&&t.length&&t[0].editVal===void 0)for(let N in t)s(0,t[+N]=Le(ye({},t[+N]),{editKey:t[+N].key,editVal:t[+N].val}),t)},[t,a,r,l,o,i,h,u,f,_,b,D,B,E]}class St extends oe{constructor(e){super();ue(this,e,Ot,Tt,fe,{attributes:0,editing:1})}}function Ht(n){let e,s,t,a=[{xmlns:"http://www.w3.org/2000/svg"},{height:"24"},{viewBox:"0 0 24 24"},{width:"24"},n[0]],r={};for(let l=0;l<a.length;l+=1)r=G(r,a[l]);return{c(){e=R("svg"),s=R("path"),t=R("path"),this.h()},l(l){e=J(l,"svg",{xmlns:!0,height:!0,viewBox:!0,width:!0});var o=y(e);s=J(o,"path",{fill:!0,d:!0}),y(s).forEach(g),t=J(o,"path",{d:!0}),y(t).forEach(g),o.forEach(g),this.h()},h(){d(s,"fill","none"),d(s,"d","M0 0h24v24H0z"),d(t,"d","M17.77 3.77 16 2 6 12l10 10 1.77-1.77L9.54 12z"),ne(e,r)},m(l,o){j(l,e,o),v(e,s),v(e,t)},p(l,[o]){ne(e,r=Ee(a,[{xmlns:"http://www.w3.org/2000/svg"},{height:"24"},{viewBox:"0 0 24 24"},{width:"24"},o&1&&l[0]]))},i:M,o:M,d(l){l&&g(e)}}}function qt(n,e,s){return n.$$set=t=>{s(0,e=G(G({},e),ie(t)))},e=ie(e),[e]}class Lt extends oe{constructor(e){super();ue(this,e,qt,Ht,fe,{})}}function Ut(n){let e,s,t,a=[{xmlns:"http://www.w3.org/2000/svg"},{height:"24"},{viewBox:"0 0 24 24"},{width:"24"},n[0]],r={};for(let l=0;l<a.length;l+=1)r=G(r,a[l]);return{c(){e=R("svg"),s=R("path"),t=R("path"),this.h()},l(l){e=J(l,"svg",{xmlns:!0,height:!0,viewBox:!0,width:!0});var o=y(e);s=J(o,"path",{d:!0,fill:!0}),y(s).forEach(g),t=J(o,"path",{d:!0}),y(t).forEach(g),o.forEach(g),this.h()},h(){d(s,"d","M0 0h24v24H0V0z"),d(s,"fill","none"),d(t,"d","m14.06 9.02.92.92L5.92 19H5v-.92l9.06-9.06M17.66 3c-.25 0-.51.1-.7.29l-1.83 1.83 3.75 3.75 1.83-1.83a.996.996 0 0 0 0-1.41l-2.34-2.34c-.2-.2-.45-.29-.71-.29zm-3.6 3.19L3 17.25V21h3.75L17.81 9.94l-3.75-3.75z"),ne(e,r)},m(l,o){j(l,e,o),v(e,s),v(e,t)},p(l,[o]){ne(e,r=Ee(a,[{xmlns:"http://www.w3.org/2000/svg"},{height:"24"},{viewBox:"0 0 24 24"},{width:"24"},o&1&&l[0]]))},i:M,o:M,d(l){l&&g(e)}}}function Kt(n,e,s){return n.$$set=t=>{s(0,e=G(G({},e),ie(t)))},e=ie(e),[e]}class Pt extends oe{constructor(e){super();ue(this,e,Kt,Ut,fe,{})}}function Ct(n){let e,s,t,a=[{xmlns:"http://www.w3.org/2000/svg"},{height:"24"},{viewBox:"0 0 24 24"},{width:"24"},n[0]],r={};for(let l=0;l<a.length;l+=1)r=G(r,a[l]);return{c(){e=R("svg"),s=R("path"),t=R("path"),this.h()},l(l){e=J(l,"svg",{xmlns:!0,height:!0,viewBox:!0,width:!0});var o=y(e);s=J(o,"path",{d:!0,fill:!0}),y(s).forEach(g),t=J(o,"path",{d:!0}),y(t).forEach(g),o.forEach(g),this.h()},h(){d(s,"d","M0 0h24v24H0V0z"),d(s,"fill","none"),d(t,"d","M9 16.2 4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z"),ne(e,r)},m(l,o){j(l,e,o),v(e,s),v(e,t)},p(l,[o]){ne(e,r=Ee(a,[{xmlns:"http://www.w3.org/2000/svg"},{height:"24"},{viewBox:"0 0 24 24"},{width:"24"},o&1&&l[0]]))},i:M,o:M,d(l){l&&g(e)}}}function Mt(n,e,s){return n.$$set=t=>{s(0,e=G(G({},e),ie(t)))},e=ie(e),[e]}class zt extends oe{constructor(e){super();ue(this,e,Mt,Ct,fe,{})}}function Rt(n){let e,s,t,a=[{xmlns:"http://www.w3.org/2000/svg"},{height:"24"},{viewBox:"0 0 24 24"},{width:"24"},n[0]],r={};for(let l=0;l<a.length;l+=1)r=G(r,a[l]);return{c(){e=R("svg"),s=R("path"),t=R("path"),this.h()},l(l){e=J(l,"svg",{xmlns:!0,height:!0,viewBox:!0,width:!0});var o=y(e);s=J(o,"path",{d:!0,fill:!0}),y(s).forEach(g),t=J(o,"path",{d:!0}),y(t).forEach(g),o.forEach(g),this.h()},h(){d(s,"d","M0 0h24v24H0V0z"),d(s,"fill","none"),d(t,"d","M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"),ne(e,r)},m(l,o){j(l,e,o),v(e,s),v(e,t)},p(l,[o]){ne(e,r=Ee(a,[{xmlns:"http://www.w3.org/2000/svg"},{height:"24"},{viewBox:"0 0 24 24"},{width:"24"},o&1&&l[0]]))},i:M,o:M,d(l){l&&g(e)}}}function Jt(n,e,s){return n.$$set=t=>{s(0,e=G(G({},e),ie(t)))},e=ie(e),[e]}class nt extends oe{constructor(e){super();ue(this,e,Jt,Rt,fe,{})}}function Ne(n){return n?JSON.parse(JSON.stringify(n)):null}function xe(n){let e,s,t,a,r,l,o,i,h;return t=new zt({}),l=new nt({}),{c(){e=I("div"),s=I("button"),ee(t.$$.fragment),a=q(),r=I("button"),ee(l.$$.fragment),this.h()},l(u){e=A(u,"DIV",{id:!0,class:!0});var f=y(e);s=A(f,"BUTTON",{id:!0,class:!0});var _=y(s);te(t.$$.fragment,_),_.forEach(g),a=L(f),r=A(f,"BUTTON",{id:!0,class:!0});var b=y(r);te(l.$$.fragment,b),b.forEach(g),f.forEach(g),this.h()},h(){d(s,"id","done"),d(s,"class","svelte-hv9as5"),d(r,"id","cancel"),d(r,"class","svelte-hv9as5"),d(e,"id","controls"),d(e,"class","svelte-hv9as5")},m(u,f){j(u,e,f),v(e,s),se(t,s,null),v(e,a),v(e,r),se(l,r,null),o=!0,i||(h=[C(s,"click",n[10]),C(r,"click",n[8])],i=!0)},p:M,i(u){o||(U(t.$$.fragment,u),U(l.$$.fragment,u),o=!0)},o(u){P(t.$$.fragment,u),P(l.$$.fragment,u),o=!1},d(u){u&&g(e),le(t),le(l),i=!1,je(h)}}}function Gt(n){let e,s,t,a;return{c(){e=I("input"),this.h()},l(r){e=A(r,"INPUT",{type:!0,id:!0,placeholder:!0,class:!0}),this.h()},h(){var r;d(e,"type","text"),d(e,"id","name"),e.value=s=(r=n[0])==null?void 0:r.name,d(e,"placeholder","Name"),d(e,"class","svelte-hv9as5")},m(r,l){j(r,e,l),t||(a=C(e,"input",n[9]),t=!0)},p(r,l){var o;l&1&&s!==(s=(o=r[0])==null?void 0:o.name)&&e.value!==s&&(e.value=s)},d(r){r&&g(e),t=!1,a()}}}function Xt(n){var a;let e,s=(((a=n[0])==null?void 0:a.name)||"")+"",t;return{c(){e=I("p"),t=W(s),this.h()},l(r){e=A(r,"P",{class:!0});var l=y(e);t=F(l,s),l.forEach(g),this.h()},h(){d(e,"class","svelte-hv9as5")},m(r,l){j(r,e,l),v(e,t)},p(r,l){var o;l&1&&s!==(s=(((o=r[0])==null?void 0:o.name)||"")+"")&&ae(t,s)},d(r){r&&g(e)}}}function et(n){let e,s,t,a,r,l;const o=[Wt,Qt],i=[];function h(u,f){return u[5]?0:1}return s=h(n),t=i[s]=o[s](n),{c(){e=I("button"),t.c(),this.h()},l(u){e=A(u,"BUTTON",{class:!0});var f=y(e);t.l(f),f.forEach(g),this.h()},h(){d(e,"class","svelte-hv9as5")},m(u,f){j(u,e,f),i[s].m(e,null),a=!0,r||(l=C(e,"click",n[8]),r=!0)},p(u,f){let _=s;s=h(u),s!==_&&(Ae(),P(i[_],1,1,()=>{i[_]=null}),Ie(),t=i[s],t||(t=i[s]=o[s](u),t.c()),U(t,1),t.m(e,null))},i(u){a||(U(t),a=!0)},o(u){P(t),a=!1},d(u){u&&g(e),i[s].d(),r=!1,l()}}}function Qt(n){let e,s;return e=new Pt({}),{c(){ee(e.$$.fragment)},l(t){te(e.$$.fragment,t)},m(t,a){se(e,t,a),s=!0},i(t){s||(U(e.$$.fragment,t),s=!0)},o(t){P(e.$$.fragment,t),s=!1},d(t){le(e,t)}}}function Wt(n){let e,s;return e=new nt({}),{c(){ee(e.$$.fragment)},l(t){te(e.$$.fragment,t)},m(t,a){se(e,t,a),s=!0},i(t){s||(U(e.$$.fragment,t),s=!0)},o(t){P(e.$$.fragment,t),s=!1},d(t){le(e,t)}}}function Ft(n){var Be,Oe;let e,s,t,a,r,l,o,i,h,u,f,_,b,D,B,E,c,k,N,T,O,Z,$,_e,ce,w,z,x;function K(m){n[14](m)}let p={};n[4]!==void 0&&(p.images=n[4]),l=new vt({props:p}),ge.push(()=>ve(l,"images",K));function X(m){n[15](m)}function re(m){n[16](m)}let he={};n[0]!==void 0&&(he.item=n[0]),n[5]!==void 0&&(he.editing=n[5]),u=new It({props:he}),ge.push(()=>ve(u,"item",X)),ge.push(()=>ve(u,"editing",re));function it(m){n[17](m)}function rt(m){n[18](m)}let De={};n[3]!==void 0&&(De.attributes=n[3]),n[5]!==void 0&&(De.editing=n[5]),D=new St({props:De}),ge.push(()=>ve(D,"attributes",it)),ge.push(()=>ve(D,"editing",rt));let S=n[5]&&xe(n);$=new Lt({});function Te(m,V){return m[5]?Gt:Xt}let ke=Te(n),Q=ke(n),H=((Be=n[1])==null?void 0:Be.accessLevel)&&((Oe=n[1])==null?void 0:Oe.accessLevel)>=2&&et(n);return{c(){e=I("div"),s=q(),t=I("div"),a=I("div"),r=I("div"),ee(l.$$.fragment),h=q(),ee(u.$$.fragment),b=q(),ee(D.$$.fragment),c=q(),k=I("div"),N=q(),S&&S.c(),T=q(),O=I("div"),Z=I("button"),ee($.$$.fragment),_e=q(),Q.c(),ce=q(),H&&H.c(),this.h()},l(m){e=A(m,"DIV",{id:!0,class:!0}),y(e).forEach(g),s=L(m),t=A(m,"DIV",{id:!0,class:!0});var V=y(t);a=A(V,"DIV",{style:!0});var me=y(a);r=A(me,"DIV",{style:!0});var de=y(r);te(l.$$.fragment,de),de.forEach(g),me.forEach(g),h=L(V),te(u.$$.fragment,V),b=L(V),te(D.$$.fragment,V),c=L(V),k=A(V,"DIV",{id:!0,class:!0}),y(k).forEach(g),N=L(V),S&&S.l(V),V.forEach(g),T=L(m),O=A(m,"DIV",{id:!0,class:!0});var Y=y(O);Z=A(Y,"BUTTON",{class:!0});var pe=y(Z);te($.$$.fragment,pe),pe.forEach(g),_e=L(Y),Q.l(Y),ce=L(Y),H&&H.l(Y),Y.forEach(g),this.h()},h(){d(e,"id","space-top"),d(e,"class","svelte-hv9as5"),d(r,"style",i=`position: relative; top: ${n[6]/2}px`),mt(a,"overflow","hidden"),d(k,"id","space-bottom"),d(k,"class","svelte-hv9as5"),d(t,"id","body"),d(t,"class","svelte-hv9as5"),d(Z,"class","svelte-hv9as5"),d(O,"id","header"),d(O,"class","svelte-hv9as5")},m(m,V){j(m,e,V),j(m,s,V),j(m,t,V),v(t,a),v(a,r),se(l,r,null),v(t,h),se(u,t,null),v(t,b),se(D,t,null),v(t,c),v(t,k),v(t,N),S&&S.m(t,null),j(m,T,V),j(m,O,V),v(O,Z),se($,Z,null),v(O,_e),Q.m(O,null),v(O,ce),H&&H.m(O,null),w=!0,z||(x=[C(t,"scroll",n[11]),C(Z,"click",n[19])],z=!0)},p(m,[V]){var pe,Se;const me={};!o&&V&16&&(o=!0,me.images=m[4],be(()=>o=!1)),l.$set(me),(!w||V&64&&i!==(i=`position: relative; top: ${m[6]/2}px`))&&d(r,"style",i);const de={};!f&&V&1&&(f=!0,de.item=m[0],be(()=>f=!1)),!_&&V&32&&(_=!0,de.editing=m[5],be(()=>_=!1)),u.$set(de);const Y={};!B&&V&8&&(B=!0,Y.attributes=m[3],be(()=>B=!1)),!E&&V&32&&(E=!0,Y.editing=m[5],be(()=>E=!1)),D.$set(Y),m[5]?S?(S.p(m,V),V&32&&U(S,1)):(S=xe(m),S.c(),U(S,1),S.m(t,null)):S&&(Ae(),P(S,1,1,()=>{S=null}),Ie()),ke===(ke=Te(m))&&Q?Q.p(m,V):(Q.d(1),Q=ke(m),Q&&(Q.c(),Q.m(O,ce))),((pe=m[1])==null?void 0:pe.accessLevel)&&((Se=m[1])==null?void 0:Se.accessLevel)>=2?H?(H.p(m,V),V&2&&U(H,1)):(H=et(m),H.c(),U(H,1),H.m(O,null)):H&&(Ae(),P(H,1,1,()=>{H=null}),Ie())},i(m){w||(U(l.$$.fragment,m),U(u.$$.fragment,m),U(D.$$.fragment,m),U(S),U($.$$.fragment,m),U(H),w=!0)},o(m){P(l.$$.fragment,m),P(u.$$.fragment,m),P(D.$$.fragment,m),P(S),P($.$$.fragment,m),P(H),w=!1},d(m){m&&g(e),m&&g(s),m&&g(t),le(l),le(u),le(D),S&&S.d(),m&&g(T),m&&g(O),le($),Q.d(),H&&H.d(),z=!1,je(x)}}}function Yt(n,e,s){let t,a;we(n,st,w=>s(2,a=w));const r=tt("userData");we(n,r,w=>s(1,t=w));let l=ze.getItem("equipment"),o=l==null?void 0:l.find(w=>w.name==a.params.equipmentName),i=Ne(o),h=Ne(i),u=(i==null?void 0:i.attributes)||[],f=[],_=!1;async function b(){var w,z,x;s(4,f=Array(((w=i==null?void 0:i.imageOrder)==null?void 0:w.length)||0).fill({src:"",done:!1}));for(let K=0;K<((z=i.tinySRC)==null?void 0:z.length);K++)s(4,f[K].src=i.tinySRC[K],f);s(0,i.imgSRC=[],i);for(let K=0;K<((x=i==null?void 0:i.imageOrder)==null?void 0:x.length);K++)s(0,i.imgSRC[K]=await kt(i,!1,K),i),s(4,f[K]={src:i.imgSRC[K],done:!0},f)}let D=!1;function B(){s(5,_=!_),!_&&(s(0,i=JSON.parse(JSON.stringify(h))),s(3,u=(i==null?void 0:i.attributes)||[]),console.log(u))}function E(w){s(0,i.name=w.target.value,i)}async function c(){if(s(5,_=!1),!i||!h)return console.log("No item or itemBefore!",i,h);let w={};const z=pt();if(i.name!==h.name&&(w={name:i.name},yt(i.id,i.name)),i.projectAssigned!==h.projectAssigned){console.log(i.projectAssigned,h.projectAssigned);const p=await wt(i.assignmentRef);console.log(p),w=ye({projectAssigned:i.projectAssigned,userAssigned:t.displayName,timeAssigned:z},w);const X=await Ce("assignments",{businessID:t.businessID,nextAssignment:null,lastProjectID:(p==null?void 0:p.projectID)||null,lastProjectName:(p==null?void 0:p.projectName)||null,lastUserID:(p==null?void 0:p.userID)||null,lastUsername:(p==null?void 0:p.username)||null,projectID:i.projectID,projectName:i.projectAssigned,equipmentID:i.id,equipmentName:i.name,userID:t.uid,username:t.displayName,createdAt:z});Me("assignments",p==null?void 0:p.id,{nextAssignment:X})}const x=u.filter(p=>{var X,re;return!p.hidden&&(((X=p.editKey)==null?void 0:X.length)>0||((re=p.key)==null?void 0:re.length)>0)}).map(p=>{var X,re,he;return{key:(X=p==null?void 0:p.key)==null?void 0:X.trim(),val:p==null?void 0:p.val,editKey:((re=p==null?void 0:p.editKey)==null?void 0:re.trim())||((he=p==null?void 0:p.key)==null?void 0:he.trim()),editVal:(p==null?void 0:p.editVal)||(p==null?void 0:p.val)}}),K=x.map(p=>p.editKey);if(s(3,u=x.filter((p,X)=>K.indexOf(p.editKey)===X).map(p=>({key:p.editKey||p.key,val:p.editVal||p.val}))),JSON.stringify(u)!==JSON.stringify(h.attributes)&&(w=ye({attributes:u},w)),console.log(w),!!Object.keys(w).length){Me("equipment",i.id,w),Ce("edits",{collection:"equipment",user:t.uid,before:h,createdAt:z}),s(0,i.attributes=u,i);for(let p in l)l[+p].id==i.id&&s(12,l[+p]=i,l);ze.setItem("equipment",l),location.reload()}}let k=0;function N(w){s(6,k=w.target.scrollTop)}function T(w){f=w,s(4,f)}function O(w){i=w,s(0,i),s(1,t),s(12,l),s(2,a)}function Z(w){_=w,s(5,_)}function $(w){u=w,s(3,u),s(1,t),s(12,l),s(2,a),s(0,i)}function _e(w){_=w,s(5,_)}const ce=async()=>Et(`/${a.params.businessName}/equipment`);return n.$$.update=()=>{var w;n.$$.dirty&4103&&t&&!l&&(async()=>(s(12,l=await lt(t.businessID,"equipment")),s(0,i=l==null?void 0:l.find(z=>z.name==a.params.equipmentName)),s(3,u=(i==null?void 0:i.attributes)||[]),h=Ne(i)||{},console.log(t)))(),n.$$.dirty&8193&&((w=i==null?void 0:i.imageOrder)==null?void 0:w.length)&&!D&&(s(13,D=!0),b())},[i,t,a,u,f,_,k,r,B,E,c,N,l,D,T,O,Z,$,_e,ce]}class us extends oe{constructor(e){super();ue(this,e,Yt,Ft,fe,{})}}export{us as default};
